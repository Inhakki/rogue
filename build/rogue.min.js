!function(a){"use strict";"function"==typeof define&&define.amd?define(["underscore","element-kit"],function(b){return a(b)}):window.Rogue=a(window._)}(function(){"use strict";function a(a){var b,c,d=a;for(c=1;c<arguments.length;c++){b=arguments[c];for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e])}return d}var b=function(a,b,c){var d,e,f=a.length;for(d=0;f>d;d++)e=a[d],e.kit[b].apply(e.kit,c)},c=function(a){this.initialize(a)};c.prototype={initialize:function(b){this.options=a({el:null,showEvent:null,hideEvent:null,onShow:null,onHide:null,cssPrefix:"ui-tooltip"},b),this.prefix=this.options.cssPrefix,this.activeClass=this.prefix+"-active",this.el=this.options.el,this.trigger=this.el.getElementsByClassName(this.prefix+"-trigger")[0],this.setup()},setup:function(){var a=this.options;a.showEvent&&(this.eventMap=this._setupEvents(a.showEvent,a.hideEvent))},_setupEvents:function(a,b){var c,d,e=this._buildEventMap(a,b);for(c in e)e.hasOwnProperty(c)&&(d=e[c],this.trigger.addEventListener(d.name,d.event));return e},_onDuplicateEvent:function(){this.isActive()?this.hide():this.show()},_buildEventMap:function(a,b){var c={};return a===b?(c.showEvent={name:a,event:this._onDuplicateEvent.bind(this)},c):(a&&(c.showEvent={name:a,event:this.show.bind(this)}),b&&(c.hideEvent={name:b,event:this.hide.bind(this)}),c)},show:function(){this.el.kit.classList.add(this.activeClass),this.options.onShow&&this.options.onShow()},hide:function(){this.el.kit.classList.remove(this.activeClass),this.options.onHide&&this.options.onHide()},isActive:function(){return this.el.kit.classList.contains(this.activeClass)},destroy:function(){var a,b,c=this.eventMap;if(c)for(a in c)c.hasOwnProperty(a)&&(b=c[a],this.trigger.removeEventListener(b.name,b.event))}};var d=function(a){this.initialize(a)};d.prototype={initialize:function(b){this.options=a({containerEl:document.getElementsByTagName("body")[0],el:null,onHide:null,onShow:null,onClickOutside:this.hide.bind(this),activeClass:"modal-active",containerActiveClass:"modal-container-active"},b),this.container=this.options.containerEl,this.content=this.options.el},setup:function(){this.container.contains(this.content)||this.container.appendChild(this.content)},show:function(){this.setup(),this.content.kit.classList.add(this.options.activeClass),document.addEventListener("click",this._onDocClick.bind(this),!0),this.container.kit.classList.add(this.options.containerActiveClass),this.options.onShow&&this.options.onShow()},hide:function(){this.content.kit.classList.remove(this.options.activeClass),document.removeEventListener("click",this._onDocClick.bind(this),!0),this.container.getElementsByClassName(this.options.activeClass).length||this.container.kit.classList.remove(this.options.containerActiveClass),this.options.onHide&&this.options.onHide()},isActive:function(){return this.content.classList.contains(this.options.activeClass)},_onDocClick:function(a){var b=a.target,c=!this.content.contains(b);c&&this.isActive()&&this.options.onClickOutside&&this.options.onClickOutside()},destroy:function(){this.content.kit.classList.remove(this.options.activeClass),this.container.contains(this.content)&&this.container.removeChild(this.content),this.container.getElementsByClassName(this.options.activeClass).length||this.container.kit.classList.remove(this.options.containerActiveClass),document.removeEventListener("click",this._onDocClick.bind(this),!0)}};var e={setValue:function(a,b,c,d){d=d||this._getCallback(arguments),this._delegateMethod(localStorage,"setItem",a,b,d),c&&this._setupFlushTime(a,c)},getValue:function(a,b){return this._delegateMethod(localStorage,"getItem",a,null,b)},flushValue:function(a,b){this._delegateMethod(localStorage,"removeItem",a,null,b)},setSessionValue:function(a,b,c){this._delegateMethod(sessionStorage,"setItem",a,b,c)},getSessionValue:function(a,b){return this._delegateMethod(sessionStorage,"getItem",a,null,b)},flushSessionValue:function(a,b){this._delegateMethod(sessionStorage,"removeItem",a,null,b)},_setupFlushTime:function(a,b){this.timers=this.timers||{},this.timers[a]=setTimeout(function(){this.flushValue.call(this,a,function(){clearTimeout(this.timers[a])}.bind(this))}.bind(this),b)},_getCallback:function(){return"function"==typeof arguments[arguments.length-1]?arguments[arguments.length-1]:null},_delegateMethod:function(a,b,c,d,e){return"getItem"===b||"getItem"===b?d=a[b](c):d?a[b](c,d):a[b](c),e&&e(d),d},_constructErrorMessage:function(a){return"CacheManager error: "+a},cacheData:function(a,b){this.setValue(a,b)},getCacheData:function(a){return this.getValue(a)},flushData:function(a){this.flushValue(a)}},f=function(a){this.initialize(a)};f.prototype={initialize:function(b){this.options=a({thumbnails:[],thumbnailActiveTriggerEvent:"click",thumbnailActiveClass:"carousel-thumbnail-active",onChange:null},b),this.setup()},setup:function(){var a=this.options.thumbnails;a.length?b(a,"addEventListener",[this.options.thumbnailActiveTriggerEvent,"onThumbnailEvent",this]):console.error("carousel thumb error: no thumbnails were passed to constructor")},onThumbnailEvent:function(a){this._thumbnailArr||(this._thumbnailArr=Array.prototype.slice.call(this.options.thumbnails));var b=this._thumbnailArr.indexOf(a.currentTarget);-1!==b&&b!==this.getCurrentIndex()&&this.options.onChange&&this.options.onChange(b)},_checkForInitErrors:function(){var a=this.options,b=a.thumbnails.length;b||console.error("carousel error: no thumbnails were passed in constructor")},goTo:function(a){var b=this.options.thumbnails,c=this.getCurrentIndex()||0,d=this.options.thumbnailActiveClass,e=b.length-1,f=0;(a>e||f>a)&&console.error("carousel thumbnail error: unable to transition to a thumbnail with an index of "+a+", it does not exist!"),b[a].kit.classList.add(d),c!==a&&b[c].kit.classList.remove(d),this._currentIndex=a},getCurrentIndex:function(){return this._currentIndex},destroy:function(){var a=this.options,c=a.thumbnails;this._currentIndex=null,c.length&&b(c,"removeEventListener",[a.thumbnailActiveTriggerEvent,"onThumbnailEvent",this])}};var g=function(a){this.initialize(a)};g.prototype={initialize:function(b){this.options=a({panels:[],assetClass:null,assetLoadingClass:"carousel-asset-loading",autoLoadAssets:!0,panelActiveClass:"carousel-panel-active",onChange:null,lazyLoadAttr:"data-src"},b),this._checkForInitErrors()},_checkForInitErrors:function(){var a=this.options,b=a.panels.length;b||console.error("carousel error: no panels were passed in constructor")},goTo:function(a){var b=this.options.panels.length-1,c=0,d=this.getCurrentIndex();(a>b||c>a)&&console.error("carousel panel error: unable to transition to an index of "+a+"which does not exist!"),(void 0===d||d!==a)&&(this._updatePanels(a),this._currentIndex=a,this.options.onChange&&this.options.onChange(a))},_updatePanels:function(a){var b=this.options.panels,c=this.getCurrentIndex();void 0!==c&&b[c].kit.classList.remove(this.options.panelActiveClass),b[a].kit.classList.add(this.options.panelActiveClass),this.options.autoLoadAssets&&this.loadPanelAssets(a)},getCurrentIndex:function(){return this._currentIndex},loadPanelAssets:function(a){var b,c,d=this.options.panels[a],e=this.options.assetClass?d.getElementsByClassName(this.options.assetClass):[d],f=e.length;for(b=0;f>b;b++)c=e[b],c.getAttribute(this.options.lazyLoadAttr)&&("img"===c.tagName.toLowerCase()?this._loadImageAsset(c):console.warn("carousel error: no matching img elements to lazy load. try supplying a valid assetClass option to constructor"))},_loadImageAsset:function(a,b){var c=new Image,d=a.getAttribute(this.options.lazyLoadAttr),e=this.options.assetLoadingClass;a.kit.classList.add(e),c.onload=function(){a.src=d,a.kit.classList.remove(e),b?b():null},c.src=d},destroy:function(){var a=this.options;a.panels[this.getCurrentIndex()].kit.classList.remove(a.panelActiveClass),this._currentIndex=null}};var h=function(a){this.initialize(a)};h.prototype={initialize:function(b){this.options=a({panels:[],assetClass:null,assetLoadingClass:"carousel-asset-loading",autoLoadAssets:!0,panelActiveClass:"carousel-panel-active",onPanelChange:null,lazyLoadAttr:"data-src",thumbnails:[],thumbnailActiveTriggerEvent:"click",thumbnailActiveClass:"carousel-thumbnail-active",initialIndex:0},b),this._checkForInitErrors(),this.setup()},setup:function(){this.panels=new g(a({},this.options,{onChange:this.onPanelChange.bind(this)})),this.options.thumbnails.length&&(this.thumbnails=new f(a({},this.options,{onChange:this.onThumbnailChange.bind(this)}))),"number"==typeof this.options.initialIndex&&this.goTo(this.options.initialIndex)},_checkForInitErrors:function(){var a=this.options,b=a.panels.length,c=a.thumbnails.length;c&&c!==b&&console.warn("carousel warning: number of thumbnails passed in constructor do not equal the number of panels\npanels: "+b+"\nthumbnails: "+c+"\n")},onPanelChange:function(a){this.thumbnails&&this.thumbnails.goTo(a),this.options.onPanelChange&&this.options.onPanelChange(a)},onThumbnailChange:function(a){this.goTo(a)},goTo:function(a){var b=this.options,c=b.panels.length-1,d=0;a>c?a=d:d>a&&(a=c),this.panels.goTo(a),this.thumbnails&&this.thumbnails.goTo(a)},goToPanel:function(a){this.goTo(a)},getCurrentIndex:function(){return this.panels.getCurrentIndex()},destroy:function(){this.panels.destroy(),this.thumbnails&&this.thumbnails.destroy()}};var i=function(){this.initialize()};return i.prototype={initialize:function(){this._head=document.getElementsByTagName("head")[0],this._cssPaths={},this._scriptPaths={}},loadScript:function(a,b){var c;this._forEachPath(a,function(a){this._scriptPaths[a]||(this._scriptPaths[a]=a,c=document.createElement("script"),c.setAttribute("type","text/javascript"),c.setAttribute("src",a),this._head.appendChild(c))}.bind(this),b)},unloadScript:function(a,b){var c;this._forEachPath(a,function(a){c=this._head.querySelectorAll('script[src="'+a+'"]')[0],c&&(this._head.removeChild(c),this._scriptPaths[a]=null)}.bind(this),b)},loadCss:function(a,b){this._forEachPath(a,function(a){if(!this._cssPaths[a]){var b=document.createElement("link");b.setAttribute("rel","stylesheet"),b.setAttribute("href",a),this._head.appendChild(b),this._cssPaths[a]=b}}.bind(this),b)},unloadCss:function(a,b){var c;this._forEachPath(a,function(a){c=this._cssPaths[a],c&&(this._head.removeChild(c),this._cssPaths[a]=null)}.bind(this),b)},_forEachPath:function(a,b,c){"string"==typeof a&&(a=[a]),a.forEach(b),c?c():null},flush:function(){this.unloadCss(Object.getOwnPropertyNames(this._cssPaths)),this.unloadScript(Object.getOwnPropertyNames(this._scriptPaths))}},{CacheManager:e,Tooltip:c,Modal:d,Carousel:h,ResourceManager:new i}});